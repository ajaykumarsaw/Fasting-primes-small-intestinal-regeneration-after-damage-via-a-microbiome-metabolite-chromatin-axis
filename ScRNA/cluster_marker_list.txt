


source  /rsrch3/home/genomic_med/aksaw/miniforge3/bin/activate 
conda activate EMT_PROJECT

library(presto)
library(Seurat)
set.seed(4567)

seurat.integrated <- readRDS("seurat_integrated.rds")

head(Idents(seurat.integrated))  ## for number of clustering identification

DefaultAssay(seurat.integrated) <- "RNA"
## need to  joined layered.
seurat.integrated <- JoinLayers(object = seurat.integrated)

for (i in 0:13) {
  assign(paste0("Cluster", i, ".marker"), FindMarkers(seurat.integrated, ident.1 = i, min.pct = 0.1, only.pos = TRUE, logfc.threshold = 0.10))
  write.table(get(paste0("Cluster", i, ".marker")), file = paste0("Cluster", i, ".marker.csv"), sep = ",")
  }


